{"ast":null,"code":"\"use strict\";\n\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all) __defProp(target, name, {\n    get: all[name],\n    enumerable: true\n  });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from)) if (!__hasOwnProp.call(to, key) && key !== except) __defProp(to, key, {\n      get: () => from[key],\n      enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable\n    });\n  }\n  return to;\n};\nvar __toCommonJS = mod => __copyProps(__defProp({}, \"__esModule\", {\n  value: true\n}), mod);\n\n// src/index.ts\nvar src_exports = {};\n__export(src_exports, {\n  MAX_Z_INDEX: () => MAX_Z_INDEX,\n  ariaAttr: () => ariaAttr,\n  contains: () => contains,\n  createScope: () => createScope,\n  dataAttr: () => dataAttr,\n  getActiveElement: () => getActiveElement,\n  getByText: () => getByText,\n  getByTypeahead: () => getByTypeahead,\n  getComputedStyle: () => getComputedStyle,\n  getDocument: () => getDocument2,\n  getEventTarget: () => getEventTarget,\n  getParent: () => getParent,\n  getPlatform: () => getPlatform,\n  getScrollParent: () => getScrollParent,\n  getScrollParents: () => getScrollParents,\n  getWindow: () => getWindow,\n  indexOfId: () => indexOfId,\n  isApple: () => isApple,\n  isDom: () => isDom,\n  isEditableElement: () => isEditableElement,\n  isFirefox: () => isFirefox,\n  isHTMLElement: () => isHTMLElement,\n  isIPhone: () => isIPhone,\n  isIos: () => isIos,\n  isMac: () => isMac,\n  isSafari: () => isSafari,\n  isSelfEvent: () => isSelfEvent,\n  isTouchDevice: () => isTouchDevice,\n  itemById: () => itemById,\n  nextById: () => nextById,\n  nextTick: () => nextTick,\n  prevById: () => prevById,\n  query: () => query,\n  queryAll: () => queryAll,\n  raf: () => raf\n});\nmodule.exports = __toCommonJS(src_exports);\n\n// src/attrs.ts\nvar dataAttr = guard => {\n  return guard ? \"\" : void 0;\n};\nvar ariaAttr = guard => {\n  return guard ? \"true\" : void 0;\n};\n\n// src/is-html-element.ts\nfunction isHTMLElement(value) {\n  return typeof value === \"object\" && value?.nodeType === Node.ELEMENT_NODE && typeof value?.nodeName === \"string\";\n}\n\n// src/contains.ts\nfunction contains(parent, child) {\n  if (!parent || !child) return false;\n  if (!isHTMLElement(parent) || !isHTMLElement(child)) return false;\n  return parent === child || parent.contains(child);\n}\nvar isSelfEvent = event => contains(event.currentTarget, event.target);\n\n// src/create-scope.ts\nvar getDocument = node => {\n  if (node.nodeType === Node.DOCUMENT_NODE) return node;\n  return node.ownerDocument ?? document;\n};\nfunction createScope(methods) {\n  const screen = {\n    getRootNode: ctx => ctx.getRootNode?.() ?? document,\n    getDoc: ctx => getDocument(screen.getRootNode(ctx)),\n    getWin: ctx => screen.getDoc(ctx).defaultView ?? window,\n    getActiveElement: ctx => screen.getDoc(ctx).activeElement,\n    getById: (ctx, id) => screen.getRootNode(ctx).getElementById(id)\n  };\n  return {\n    ...screen,\n    ...methods\n  };\n}\n\n// src/env.ts\nvar isDocument = el => el.nodeType === Node.DOCUMENT_NODE;\nfunction getDocument2(el) {\n  if (isDocument(el)) return el;\n  return el?.ownerDocument ?? document;\n}\nfunction getWindow(el) {\n  return el?.ownerDocument.defaultView ?? window;\n}\n\n// src/get-active-element.ts\nfunction getActiveElement(el) {\n  let activeElement = el.ownerDocument.activeElement;\n  while (activeElement?.shadowRoot) {\n    const el2 = activeElement.shadowRoot.activeElement;\n    if (el2 === activeElement) break;else activeElement = el2;\n  }\n  return activeElement;\n}\n\n// src/get-by-id.ts\nfunction itemById(v, id) {\n  return v.find(node => node.id === id);\n}\nfunction indexOfId(v, id) {\n  const item = itemById(v, id);\n  return item ? v.indexOf(item) : -1;\n}\nfunction nextById(v, id, loop = true) {\n  let idx = indexOfId(v, id);\n  idx = loop ? (idx + 1) % v.length : Math.min(idx + 1, v.length - 1);\n  return v[idx];\n}\nfunction prevById(v, id, loop = true) {\n  let idx = indexOfId(v, id);\n  if (idx === -1) return loop ? v[v.length - 1] : null;\n  idx = loop ? (idx - 1 + v.length) % v.length : Math.max(0, idx - 1);\n  return v[idx];\n}\n\n// src/get-by-text.ts\nvar getValueText = item => item.dataset.valuetext ?? item.textContent ?? \"\";\nvar match = (valueText, query2) => valueText.toLowerCase().startsWith(query2.toLowerCase());\nvar wrap = (v, idx) => {\n  return v.map((_, index) => v[(Math.max(idx, 0) + index) % v.length]);\n};\nfunction getByText(v, text, currentId) {\n  const index = currentId ? indexOfId(v, currentId) : -1;\n  let items = currentId ? wrap(v, index) : v;\n  const isSingleKey = text.length === 1;\n  if (isSingleKey) {\n    items = items.filter(item => item.id !== currentId);\n  }\n  return items.find(item => match(getValueText(item), text));\n}\n\n// src/get-by-typeahead.ts\nfunction getByTypeaheadImpl(_items, options) {\n  const {\n    state,\n    activeId,\n    key,\n    timeout = 350\n  } = options;\n  const search = state.keysSoFar + key;\n  const isRepeated = search.length > 1 && Array.from(search).every(char => char === search[0]);\n  const query2 = isRepeated ? search[0] : search;\n  let items = _items.slice();\n  const next = getByText(items, query2, activeId);\n  function cleanup() {\n    clearTimeout(state.timer);\n    state.timer = -1;\n  }\n  function update(value) {\n    state.keysSoFar = value;\n    cleanup();\n    if (value !== \"\") {\n      state.timer = +setTimeout(() => {\n        update(\"\");\n        cleanup();\n      }, timeout);\n    }\n  }\n  update(search);\n  return next;\n}\nvar getByTypeahead = /* @__PURE__ */Object.assign(getByTypeaheadImpl, {\n  defaultOptions: {\n    keysSoFar: \"\",\n    timer: -1\n  },\n  isValidEvent: isValidTypeaheadEvent\n});\nfunction isValidTypeaheadEvent(event) {\n  return event.key.length === 1 && !event.ctrlKey && !event.metaKey;\n}\n\n// src/get-computed-style.ts\nvar styleCache = /* @__PURE__ */new WeakMap();\nfunction getComputedStyle(el) {\n  if (!styleCache.has(el)) {\n    const win = el.ownerDocument.defaultView || window;\n    styleCache.set(el, win.getComputedStyle(el));\n  }\n  return styleCache.get(el);\n}\n\n// src/get-event-target.ts\nfunction getEventTarget(event) {\n  return event.composedPath?.()[0] ?? event.target;\n}\n\n// src/get-scroll-parent.ts\nfunction isScrollParent(el) {\n  const win = el.ownerDocument.defaultView || window;\n  const {\n    overflow,\n    overflowX,\n    overflowY\n  } = win.getComputedStyle(el);\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}\nfunction getParent(el) {\n  if (el.localName === \"html\") return el;\n  return el.assignedSlot || el.parentElement || el.ownerDocument.documentElement;\n}\nfunction getScrollParent(el) {\n  if ([\"html\", \"body\", \"#document\"].includes(el.localName)) {\n    return el.ownerDocument.body;\n  }\n  if (isHTMLElement(el) && isScrollParent(el)) {\n    return el;\n  }\n  return getScrollParent(getParent(el));\n}\nfunction getScrollParents(el, list = []) {\n  const parent = getScrollParent(el);\n  const isBody = parent === el.ownerDocument.body;\n  const win = parent.ownerDocument.defaultView || window;\n  const target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(parent) ? parent : []) : parent;\n  const parents = list.concat(target);\n  return isBody ? parents : parents.concat(getScrollParents(getParent(target)));\n}\n\n// src/is-editable-element.ts\nfunction isEditableElement(el) {\n  if (el == null || !isHTMLElement(el)) {\n    return false;\n  }\n  try {\n    const win = el.ownerDocument.defaultView || window;\n    return el instanceof win.HTMLInputElement && el.selectionStart != null || /(textarea|select)/.test(el.localName) || el.isContentEditable;\n  } catch {\n    return false;\n  }\n}\n\n// src/platform.ts\nvar isDom = () => typeof document !== \"undefined\";\nfunction getPlatform() {\n  const agent = navigator.userAgentData;\n  return agent?.platform ?? navigator.platform;\n}\nvar pt = v => isDom() && v.test(getPlatform());\nvar ua = v => isDom() && v.test(navigator.userAgent);\nvar vn = v => isDom() && v.test(navigator.vendor);\nvar isTouchDevice = () => isDom() && !!navigator.maxTouchPoints;\nvar isMac = () => pt(/^Mac/) && !isTouchDevice();\nvar isIPhone = () => pt(/^iPhone/);\nvar isSafari = () => isApple() && vn(/apple/i);\nvar isFirefox = () => ua(/firefox\\//i);\nvar isApple = () => pt(/mac|iphone|ipad|ipod/i);\nvar isIos = () => isApple() && !isMac();\n\n// src/query.ts\nfunction queryAll(root, selector) {\n  return Array.from(root?.querySelectorAll(selector) ?? []);\n}\nfunction query(root, selector) {\n  return root?.querySelector(selector);\n}\n\n// src/raf.ts\nfunction nextTick(fn) {\n  const set = /* @__PURE__ */new Set();\n  function raf2(fn2) {\n    const id = globalThis.requestAnimationFrame(fn2);\n    set.add(() => globalThis.cancelAnimationFrame(id));\n  }\n  raf2(() => raf2(fn));\n  return function cleanup() {\n    set.forEach(fn2 => fn2());\n  };\n}\nfunction raf(fn) {\n  const id = globalThis.requestAnimationFrame(fn);\n  return () => {\n    globalThis.cancelAnimationFrame(id);\n  };\n}\n\n// src/index.ts\nvar MAX_Z_INDEX = 2147483647;\n// Annotate the CommonJS export names for ESM import in node:\n0 && (module.exports = {\n  MAX_Z_INDEX,\n  ariaAttr,\n  contains,\n  createScope,\n  dataAttr,\n  getActiveElement,\n  getByText,\n  getByTypeahead,\n  getComputedStyle,\n  getDocument,\n  getEventTarget,\n  getParent,\n  getPlatform,\n  getScrollParent,\n  getScrollParents,\n  getWindow,\n  indexOfId,\n  isApple,\n  isDom,\n  isEditableElement,\n  isFirefox,\n  isHTMLElement,\n  isIPhone,\n  isIos,\n  isMac,\n  isSafari,\n  isSelfEvent,\n  isTouchDevice,\n  itemById,\n  nextById,\n  nextTick,\n  prevById,\n  query,\n  queryAll,\n  raf\n});","map":{"version":3,"names":["src_exports","__export","MAX_Z_INDEX","ariaAttr","contains","createScope","dataAttr","getActiveElement","getByText","getByTypeahead","getComputedStyle","getDocument","getDocument2","getEventTarget","getParent","getPlatform","getScrollParent","getScrollParents","getWindow","indexOfId","isApple","isDom","isEditableElement","isFirefox","isHTMLElement","isIPhone","isIos","isMac","isSafari","isSelfEvent","isTouchDevice","itemById","nextById","nextTick","prevById","query","queryAll","raf","module","exports","__toCommonJS","guard","value","nodeType","Node","ELEMENT_NODE","nodeName","parent","child","event","currentTarget","target","node","DOCUMENT_NODE","ownerDocument","document","methods","screen","getRootNode","ctx","getDoc","getWin","defaultView","window","activeElement","getById","id","getElementById","isDocument","el","shadowRoot","el2","v","find","item","indexOf","loop","idx","length","Math","min","max","getValueText","dataset","valuetext","textContent","match","valueText","query2","toLowerCase","startsWith","wrap","map","_","index","text","currentId","items","isSingleKey","filter","getByTypeaheadImpl","_items","options","state","activeId","key","timeout","search","keysSoFar","isRepeated","Array","from","every","char","slice","next","cleanup","clearTimeout","timer","update","setTimeout","Object","assign","defaultOptions","isValidEvent","isValidTypeaheadEvent","ctrlKey","metaKey","styleCache","WeakMap","has","win","set","get","composedPath","isScrollParent","overflow","overflowX","overflowY","test","localName","assignedSlot","parentElement","documentElement","includes","body","list","isBody","concat","visualViewport","parents","HTMLInputElement","selectionStart","isContentEditable","agent","navigator","userAgentData","platform","pt","ua","userAgent","vn","vendor","maxTouchPoints","root","selector","querySelectorAll","querySelector","fn","Set","raf2","fn2","globalThis","requestAnimationFrame","add","cancelAnimationFrame","forEach"],"sources":["../src/index.ts","../src/attrs.ts","../src/is-html-element.ts","../src/contains.ts","../src/create-scope.ts","../src/env.ts","../src/get-active-element.ts","../src/get-by-id.ts","../src/get-by-text.ts","../src/get-by-typeahead.ts","../src/get-computed-style.ts","../src/get-event-target.ts","../src/get-scroll-parent.ts","../src/is-editable-element.ts","../src/platform.ts","../src/query.ts","../src/raf.ts"],"sourcesContent":["export * from \"./attrs\"\nexport * from \"./contains\"\nexport * from \"./create-scope\"\nexport * from \"./env\"\nexport * from \"./get-active-element\"\nexport * from \"./get-by-id\"\nexport * from \"./get-by-text\"\nexport * from \"./get-by-typeahead\"\nexport * from \"./get-computed-style\"\nexport * from \"./get-event-target\"\nexport * from \"./get-scroll-parent\"\nexport * from \"./is-editable-element\"\nexport * from \"./is-html-element\"\nexport * from \"./platform\"\nexport * from \"./query\"\nexport * from \"./raf\"\n\nexport const MAX_Z_INDEX = 2147483647\n","type Booleanish = boolean | \"true\" | \"false\"\n\nexport const dataAttr = (guard: boolean | undefined) => {\n  return (guard ? \"\" : undefined) as Booleanish\n}\n\nexport const ariaAttr = (guard: boolean | undefined) => {\n  return guard ? \"true\" : undefined\n}\n","export function isHTMLElement(value: any): value is HTMLElement {\n  return typeof value === \"object\" && value?.nodeType === Node.ELEMENT_NODE && typeof value?.nodeName === \"string\"\n}\n","import { isHTMLElement } from \"./is-html-element\"\n\ntype Target = HTMLElement | EventTarget | null | undefined\n\nexport function contains(parent: Target, child: Target) {\n  if (!parent || !child) return false\n  if (!isHTMLElement(parent) || !isHTMLElement(child)) return false\n  return parent === child || parent.contains(child)\n}\n\nexport const isSelfEvent = (event: Pick<UIEvent, \"currentTarget\" | \"target\">) =>\n  contains(event.currentTarget, event.target)\n","type Ctx = { getRootNode?: () => Document | ShadowRoot | Node }\n\nconst getDocument = (node: Document | ShadowRoot | Node) => {\n  if (node.nodeType === Node.DOCUMENT_NODE) return node as Document\n  return node.ownerDocument ?? document\n}\n\nexport function createScope<T>(methods: T) {\n  const screen = {\n    getRootNode: (ctx: Ctx) => (ctx.getRootNode?.() ?? document) as Document | ShadowRoot,\n    getDoc: (ctx: Ctx) => getDocument(screen.getRootNode(ctx)),\n    getWin: (ctx: Ctx) => screen.getDoc(ctx).defaultView ?? window,\n    getActiveElement: (ctx: Ctx) => screen.getDoc(ctx).activeElement as HTMLElement | null,\n    getById: <T extends HTMLElement = HTMLElement>(ctx: Ctx, id: string) =>\n      screen.getRootNode(ctx).getElementById(id) as T | null,\n  }\n  return { ...screen, ...methods }\n}\n","const isDocument = (el: any): el is Document => el.nodeType === Node.DOCUMENT_NODE\n\nexport function getDocument(el: Element | Node | Document | null) {\n  if (isDocument(el)) return el\n  return el?.ownerDocument ?? document\n}\n\nexport function getWindow(el: HTMLElement) {\n  return el?.ownerDocument.defaultView ?? window\n}\n","export function getActiveElement(el: HTMLElement): HTMLElement | null {\n  let activeElement = el.ownerDocument.activeElement as HTMLElement | null\n\n  while (activeElement?.shadowRoot) {\n    const el = activeElement.shadowRoot.activeElement as HTMLElement | null\n    if (el === activeElement) break\n    else activeElement = el\n  }\n\n  return activeElement\n}\n","export function itemById<T extends HTMLElement>(v: T[], id: string) {\n  return v.find((node) => node.id === id)\n}\n\nexport function indexOfId<T extends HTMLElement>(v: T[], id: string) {\n  const item = itemById(v, id)\n  return item ? v.indexOf(item) : -1\n}\n\nexport function nextById<T extends HTMLElement>(v: T[], id: string, loop = true) {\n  let idx = indexOfId(v, id)\n  idx = loop ? (idx + 1) % v.length : Math.min(idx + 1, v.length - 1)\n  return v[idx]\n}\n\nexport function prevById<T extends HTMLElement>(v: T[], id: string, loop = true) {\n  let idx = indexOfId(v, id)\n  if (idx === -1) return loop ? v[v.length - 1] : null\n  idx = loop ? (idx - 1 + v.length) % v.length : Math.max(0, idx - 1)\n  return v[idx]\n}\n","import { indexOfId } from \"./get-by-id\"\n\nconst getValueText = <T extends HTMLElement>(item: T) => item.dataset.valuetext ?? item.textContent ?? \"\"\n\nconst match = (valueText: string, query: string) => valueText.toLowerCase().startsWith(query.toLowerCase())\n\nconst wrap = <T>(v: T[], idx: number) => {\n  return v.map((_, index) => v[(Math.max(idx, 0) + index) % v.length])\n}\n\nexport function getByText<T extends HTMLElement>(v: T[], text: string, currentId?: string | null) {\n  const index = currentId ? indexOfId(v, currentId) : -1\n  let items = currentId ? wrap(v, index) : v\n\n  const isSingleKey = text.length === 1\n\n  if (isSingleKey) {\n    items = items.filter((item) => item.id !== currentId)\n  }\n\n  return items.find((item) => match(getValueText(item), text))\n}\n","import { getByText } from \"./get-by-text\"\n\nexport type TypeaheadState = {\n  keysSoFar: string\n  timer: number\n}\n\nexport type TypeaheadOptions = {\n  state: TypeaheadState\n  activeId: string | null\n  key: string\n  timeout?: number\n}\n\nfunction getByTypeaheadImpl<T extends HTMLElement>(_items: T[], options: TypeaheadOptions) {\n  const { state, activeId, key, timeout = 350 } = options\n\n  const search = state.keysSoFar + key\n  const isRepeated = search.length > 1 && Array.from(search).every((char) => char === search[0])\n\n  const query = isRepeated ? search[0] : search\n\n  let items = _items.slice()\n\n  const next = getByText(items, query, activeId)\n\n  function cleanup() {\n    clearTimeout(state.timer)\n    state.timer = -1\n  }\n\n  function update(value: string) {\n    state.keysSoFar = value\n    cleanup()\n\n    if (value !== \"\") {\n      state.timer = +setTimeout(() => {\n        update(\"\")\n        cleanup()\n      }, timeout)\n    }\n  }\n\n  update(search)\n\n  return next\n}\nexport const getByTypeahead = /*#__PURE__*/ Object.assign(getByTypeaheadImpl, {\n  defaultOptions: { keysSoFar: \"\", timer: -1 },\n  isValidEvent: isValidTypeaheadEvent,\n})\n\nfunction isValidTypeaheadEvent(event: Pick<KeyboardEvent, \"key\" | \"ctrlKey\" | \"metaKey\">) {\n  return event.key.length === 1 && !event.ctrlKey && !event.metaKey\n}\n","const styleCache = new WeakMap<HTMLElement, any>()\n\nexport function getComputedStyle(el: HTMLElement) {\n  if (!styleCache.has(el)) {\n    const win = el.ownerDocument.defaultView || window\n    styleCache.set(el, win.getComputedStyle(el))\n  }\n  return styleCache.get(el)\n}\n","export function getEventTarget<T extends EventTarget>(event: Event): T | null {\n  return (event.composedPath?.()[0] ?? event.target) as T | null\n}\n","import { isHTMLElement } from \"./is-html-element\"\n\nfunction isScrollParent(el: HTMLElement): boolean {\n  const win = el.ownerDocument.defaultView || window\n  const { overflow, overflowX, overflowY } = win.getComputedStyle(el)\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX)\n}\n\nexport function getParent(el: HTMLElement): HTMLElement {\n  if (el.localName === \"html\") return el\n  return el.assignedSlot || el.parentElement || el.ownerDocument.documentElement\n}\n\nexport function getScrollParent(el: HTMLElement): HTMLElement {\n  if ([\"html\", \"body\", \"#document\"].includes(el.localName)) {\n    return el.ownerDocument.body\n  }\n\n  if (isHTMLElement(el) && isScrollParent(el)) {\n    return el\n  }\n\n  return getScrollParent(getParent(el))\n}\n\ntype Target = Array<VisualViewport | Window | HTMLElement | null>\n\nexport function getScrollParents(el: HTMLElement, list: Target = []): Target {\n  const parent = getScrollParent(el)\n  const isBody = parent === el.ownerDocument.body\n  const win = parent.ownerDocument.defaultView || window\n\n  //@ts-expect-error\n  const target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(parent) ? parent : []) : parent\n\n  const parents = list.concat(target)\n  return isBody ? parents : parents.concat(getScrollParents(getParent(<HTMLElement>target)))\n}\n","import { isHTMLElement } from \"./is-html-element\"\n\nexport function isEditableElement(el: HTMLElement | EventTarget | null) {\n  if (el == null || !isHTMLElement(el)) {\n    return false\n  }\n\n  try {\n    const win = el.ownerDocument.defaultView || window\n    return (\n      (el instanceof win.HTMLInputElement && el.selectionStart != null) ||\n      /(textarea|select)/.test(el.localName) ||\n      el.isContentEditable\n    )\n  } catch {\n    return false\n  }\n}\n","export const isDom = () => typeof document !== \"undefined\"\n\nexport function getPlatform() {\n  const agent = (navigator as any).userAgentData\n  return agent?.platform ?? navigator.platform\n}\n\nconst pt = (v: RegExp) => isDom() && v.test(getPlatform())\nconst ua = (v: RegExp) => isDom() && v.test(navigator.userAgent)\nconst vn = (v: RegExp) => isDom() && v.test(navigator.vendor)\n\nexport const isTouchDevice = () => isDom() && !!navigator.maxTouchPoints\nexport const isMac = () => pt(/^Mac/) && !isTouchDevice()\nexport const isIPhone = () => pt(/^iPhone/)\nexport const isSafari = () => isApple() && vn(/apple/i)\nexport const isFirefox = () => ua(/firefox\\//i)\nexport const isApple = () => pt(/mac|iphone|ipad|ipod/i)\nexport const isIos = () => isApple() && !isMac()\n","type Root = Document | Element | null | undefined\n\nexport function queryAll<T extends HTMLElement = HTMLElement>(root: Root, selector: string) {\n  return Array.from(root?.querySelectorAll<T>(selector) ?? [])\n}\n\nexport function query<T extends HTMLElement = HTMLElement>(root: Root, selector: string) {\n  return root?.querySelector<T>(selector)\n}\n","export function nextTick(fn: VoidFunction) {\n  const set = new Set<VoidFunction>()\n  function raf(fn: VoidFunction) {\n    const id = globalThis.requestAnimationFrame(fn)\n    set.add(() => globalThis.cancelAnimationFrame(id))\n  }\n  raf(() => raf(fn))\n  return function cleanup() {\n    set.forEach((fn) => fn())\n  }\n}\n\nexport function raf(fn: VoidFunction) {\n  const id = globalThis.requestAnimationFrame(fn)\n  return () => {\n    globalThis.cancelAnimationFrame(id)\n  }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script"}